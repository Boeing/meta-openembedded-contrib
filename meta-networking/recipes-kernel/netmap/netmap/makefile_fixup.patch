The makefile assumes building locally.

Upstream Status: Inappropriate [Native]

The configure is not auto-make based

Signed-of-by: Armin Kuster <akuster@mvista.com>

Index: LINUX/netmap.mak.in
===================================================================
--- a/LINUX/netmap.mak.in
+++ b/LINUX/netmap.mak.in
@@ -12,10 +12,8 @@ SRCDIR:=@SRCDIR@
 # The following commands are needed to build the modules as out-of-tree,
 # in fact the kernel sources path must be specified.
 
-PWD ?= $(CURDIR)
-
 # Additional compile flags (e.g. header location)
-EXTRA_CFLAGS := -I$(PWD) -I$(SRCDIR) -I$(SRCDIR)/../sys -I$(SRCDIR)/../sys/dev -DCONFIG_NETMAP
+EXTRA_CFLAGS := -I$(SRCDIR) -I$(SRCDIR)/../sys -I$(SRCDIR)/../sys/dev -DCONFIG_NETMAP
 EXTRA_CFLAGS += -Wno-unused-but-set-variable
 EXTRA_CFLAGS += $(foreach s,$(SUBSYS),-DCONFIG_NETMAP_$(shell echo $s|tr a-z A-Z))
 
Index: LINUX/configure
===================================================================
--- a/LINUX/configure
+++ b/LINUX/configure
@@ -311,34 +311,6 @@ reset_tests() {
 	NEXTTEST=1
 }
 
-# run_tests: run all accumulated tests and exec the pertinent
-#   success/failure actions for each one.
-run_tests() {
-	local t= 	# prevent -EOF to eat the make TAB
-	cat > $TMPDIR/Makefile <<-EOF
-		ifneq (\$(KERNELRELEASE),)
-		obj-m := $TESTOBJS
-		else
-		S_DRIVERS := $(drv print)
-		all: \$(S_DRIVERS:%=get-%)
-		$t	\$(MAKE) -C $ksrc M=\$\$PWD $kopts
-
-		-include $TOPDIR/drivers.mak
-	EOF
-	for d in $(drv print); do
-		cat >> $TMPDIR/Makefile <<-EOF
-			get-$d:
-			$t	[ -z "\$($d-src)" ] || cp -Rp \$($d-src) \$(if \$($d-dst),\$($d-dst),.)
-		EOF
-	done
-	echo endif >> $TMPDIR/Makefile
-	(
-		cd $TMPDIR
-		make -k -j $(grep -c processor /proc/cpuinfo)
-	) >> config.log
-	eval "$TESTPOSTPROC"
-}
-
 configh=netmap_linux_config.h
 # succes/failure actions are expected to write some macros
 # in netma_linux_config.h. The following functions can be
@@ -555,7 +527,6 @@ configuration. Please check 'config.log'
 
 reset_tests
 add_test true broken_buildsystem < /dev/null
-run_tests
 
 drvname2config() {
 	local name=$1
@@ -1087,7 +1058,6 @@ cat > $configh <<-EOF
 EOF
 
 # the TESTPOSTPROC script will add macros to $configh
-run_tests
 
 define DRIVER_SUFFIX \"$drvsuffix\"
 
