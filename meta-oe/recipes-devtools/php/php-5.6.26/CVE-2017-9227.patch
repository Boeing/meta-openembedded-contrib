commit 9690d3ab1f9bcd2db8cbe1fe3ee4a5da606b8814
Author: K.Kosako <kosako@sofnec.co.jp>
Date:   Tue May 23 16:15:35 2017 +0900

    fix #58 : access to invalid address by reg->dmin value

Upstream-Status: Backport

CVE: CVE-2017-9227
Signed-off-by: Thiruvadi Rajaraman <trajaraman@mvista.com>

Index: php-5.6.26/ext/mbstring/oniguruma/regexec.c
===================================================================
--- php-5.6.26.orig/ext/mbstring/oniguruma/regexec.c	2016-09-16 02:32:50.000000000 +0530
+++ php-5.6.26/ext/mbstring/oniguruma/regexec.c	2017-08-30 12:49:07.164967788 +0530
@@ -3128,6 +3128,8 @@
     }
     else {
       UChar *q = p + reg->dmin;
+
+      if (q >= end) return 0; /* fail */
       while (p < q) p += enclen(reg->enc, p);
     }
   }
