commit 266ecb6d0a1ab5a37b4d652ca774a8adc4b06578
Author: Stanislav Malyshev <stas@php.net>
Date:   Mon Dec 5 21:40:55 2016 -0800

    Fix bug #73631 - Invalid read when wddx decodes empty boolean element

Upstream-status: Backport

CVE: CVE-2016-9935
Signed-off-by: Thiruvadi Rajaraman <trajaraman@mvista.com>

Index: php-5.6.26/ext/wddx/tests/bug73631.phpt
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ php-5.6.26/ext/wddx/tests/bug73631.phpt	2017-06-15 15:31:17.362351353 +0530
@@ -0,0 +1,20 @@
+--TEST--
+Bug #73631 (Memory leak due to invalid wddx stack processing)
+--SKIPIF--
+<?php if (!extension_loaded("wddx")) print "skip"; ?>
+--FILE--
+<?php
+$xml = <<<EOF
+<?xml version="1.0" ?>
+<wddxPacket version="1.0">
+<number>1234</number>
+<binary><boolean/></binary>
+</wddxPacket>
+EOF;
+$wddx = wddx_deserialize($xml);
+var_dump($wddx);
+?>
+--EXPECTF--
+int(1234)
+
+
Index: php-5.6.26/ext/wddx/wddx.c
===================================================================
--- php-5.6.26.orig/ext/wddx/wddx.c	2017-06-15 15:31:17.306351351 +0530
+++ php-5.6.26/ext/wddx/wddx.c	2017-06-15 15:31:17.362351353 +0530
@@ -812,6 +812,11 @@
 				php_wddx_process_data(user_data, atts[i+1], strlen(atts[i+1]));
 				break;
 			}
+               } else {
+                       ent.type = ST_BOOLEAN;
+                       SET_STACK_VARNAME;
+                       ZVAL_FALSE(&ent.data);
+                       wddx_stack_push((wddx_stack *)stack, &ent, sizeof(st_entry));
 		}
 	} else if (!strcmp(name, EL_NULL)) {
 		ent.type = ST_NULL;
